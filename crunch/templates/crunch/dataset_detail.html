{% extends "base.html" %}

{% block content %}

<div class="container mt-3">

    <nav aria-label="breadcrumb ">
        <ol class="breadcrumb">
            <li class="breadcrumb-item"><a href="../..">Projects</a></li>
            <li class="breadcrumb-item"><a href="..">{{dataset.project}}</a></li>
            <li class="breadcrumb-item active" aria-current="page">{{dataset}}</li>
        </ol>
    </nav>

    <div class="float-right">
        {% if perms.crunch.add_dataset %}
            <a href="{% url 'crunch:dataset-create'  %}" class="btn btn-outline-primary btn-sm chk-saved" data-toggle="tooltip" data-placement="bottom" title="Create Dataset">
                <i class="fas fa-plus"></i>
            </a>
        {% endif %}
        {% if perms.crunch.update_dataset %}
            <a href="{% url 'crunch:dataset-update' slug=dataset.slug project=dataset.project.slug %}" class="btn btn-outline-primary btn-sm chk-saved" data-toggle="tooltip" data-placement="bottom" title="Update this Dataset">
                <i class="fas fa-edit"></i>
            </a>
        {% endif %}
        {% if request.user.is_staff %}
            <a href="{{ dataset.get_admin_url }}" class="btn btn-outline-primary btn-sm chk-saved" data-toggle="tooltip" data-placement="bottom" title="Admin">
                <i class="fas fa-tools"></i>
            </a>
        {% endif %}
        {% if dataset.prev_in_order %}
            <a href="{{ dataset.prev_in_order.get_absolute_url }}" class="btn btn-outline-primary btn-sm chk-saved" data-toggle="tooltip" data-placement="bottom" title="{{ dataset.prev_in_order }}">
                <i class="fas fa-arrow-left"></i>
            </a>
        {% endif %}
        {% if dataset.next_in_order %}
            <a href="{{ dataset.next_in_order.get_absolute_url }}" class="btn btn-outline-primary btn-sm chk-saved" data-toggle="tooltip" data-placement="bottom" title="{{ dataset.next_in_order }}">
                <i class="fas fa-arrow-right"></i>
            </a>
        {% endif %}
    </div> 

    <h2>{{dataset}}</h2>

    <h3>Project: <a href='{{dataset.project.get_absolute_url}}'>{{dataset.project}}</a></h3>

    <h3>Attributes</h3>

    <table class="table table-striped">
        <thead>
          <tr>
            <th scope="col">Attribute</th>
            <th scope="col">Type</th>
            <th scope="col">Value</th>
          </tr>
        </thead>
        <tbody>
            {% for attribute in dataset.attributes.all %}
            <tr>
                <th scope="row">{{attribute.key}}</th>
                <td>{{attribute.type_str}}</td>
                <td>{{attribute.value_html}}</td>
              </tr>
            {% endfor %}
        </tbody>
      </table>
      

      <h3>Files</h3>
      <p><i>File list not yet implemented.</i></p>
      <a href='#' class="btn btn-primary">Upload</a>

    <h3>History</h3>
    <ul>
    </ul>
    <table class="table table-striped">
        <thead>
          <tr>
            <th scope="col">Date</th>
            <th scope="col">User</th>
            <th scope="col">Stage</th>
            <th scope="col">Status</th>
          </tr>
        </thead>
        <tbody>
            {% for status in dataset.statuses.all %}
            <tr>
                <th scope="row">{{status.created}}</th>
                <td>{{status.site_user}}</td>
                <td>{{status.get_stage_display}}</td>
                <td>{{status.get_state_display}}</td>
              </tr>
            {% endfor %}
        </tbody>
      </table>
  
</div>

{% endblock content %}
